#!/bin/bash

# ----------------------------------------
# ComposerでLaravelの依存パッケージをインストール
# ----------------------------------------
composer install --no-dev --optimize-autoloader

# ----------------------------------------
# MySQL の起動を少し待機（10秒）
# ----------------------------------------
echo "⌛ Waiting for MySQL to be ready..."
sleep 10

# ----------------------------------------
# Laravelのキャッシュをクリアして再生成
# ----------------------------------------
php artisan config:clear
php artisan config:cache

# ----------------------------------------
# データベースマイグレーション（強制モード）
# ----------------------------------------
php artisan migrate --force

# ----------------------------------------
# Apache をフォアグラウンドで起動
# ----------------------------------------
apache2-foreground

